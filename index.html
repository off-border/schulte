<!DOCTYPE HTML>

<head>
    <title>shulte tables trainer</title>
    <meta type="description" content="shulte tables brain trainer">
    <link rel="stylesheet" href="main.css">
    <script src="snap.svg.js"></script>
    <script src="game.js"></script>
</head>


<body>
    <content>
        <!--        <h1>Shulte tables brain trainer</h1>-->
        <!--
        <div class="table">
            <div class="cell"><span>1</span></div>
            <div class="cell"><span>2</span></div>
            <div class="cell"><span>3</span></div>
            <div class="cell"><span>4</span></div>
            <div class="cell"><span>5</span></div>
            <div class="cell"><span>6</span></div>
            <div class="cell"><span>7</span></div>
            <div class="cell"><span>8</span></div>
            <div class="cell"><span>9</span></div>
            <div class="cell">10</div>
            <div class="cell">11</div>
            <div class="cell">12</div>
            <div class="cell">13</div>
            <div class="cell">14</div>
            <div class="cell">15</div>
            <div class="cell">16</div>
            <div class="cell">17</div>
            <div class="cell">18</div>
            <div class="cell">19</div>
            <div class="cell">20</div>
            <div class="cell">21</div>
            <div class="cell">22</div>
            <div class="cell">23</div>
            <div class="cell">24</div>
            <div class="cell">25</div>
        </div>
-->
        <div class="table-wrapper">
            <svg class="table"></svg>
        </div>

        <div class="settings">
            <input type="text" id="cols" value="5" onchange="shulte.size = this.value; shulte.createCells(); shulte.smileCells();">
            <a class="start" href="javascript:;" onclick="shulte.start();">start</a>
            <a class="stop hidden" href="javascript:;" onclick="shulte.stop();">stop</a>
            <div class="timer">Time: <span>00</span></div>
            <div class="next-number">Next: <span>00</span></div>
<!--            <div class="next">Next: 1</div>-->
        </div>




    </content>

    <script>
        var shulte = new Shulte('.table');
        var timerEl = document.querySelector('.timer span');
        var nextEl = document.querySelector('.next-number span');

        shulte.timerTicked = function(time){
            let f = Math.floor(time%1000/100);
            let d = Math.floor(time/1000);
            timerEl.innerText = d + '.' + f;
        }
        shulte.gameStarted = function(){
            nextEl.innerText = 1;
            document.querySelector('.start').classList.add('hidden');
            document.querySelector('.stop').classList.remove('hidden');
        }
        shulte.gameStopped = function(){
            document.querySelector('.start').classList.remove('hidden');
            document.querySelector('.stop').classList.add('hidden');
        }
        shulte.gameFinished = function(){
            shulte.gameStopped();
        }

        shulte.cellClicked = function(number){
            if( number < shulte.numbers.length )
                nextEl.innerText = number+1;
        }

        window.addEventListener('load', function(){
            shulte.size = document.getElementById('cols').value;
            shulte.createCells();
            shulte.smileCells();
            alignTable();
        })
        window.addEventListener('resize', alignTable);

        function alignTable() {
            let tableEl = document.querySelector('.table');
            let settingsEl = document.querySelector('.settings');
            let settingsRect = settingsEl.getBoundingClientRect();
            let winWidth =  window.innerWidth;
            let winHeight = window.innerHeight;

            tableWidth = Math.min(winWidth, winHeight) -
                tableEl.getBoundingClientRect().y * 2;

            if( winWidth/2 + tableWidth/2 > settingsRect.left ){
                tableEl.parentElement.style.width = settingsRect.left + 'px';
                if( tableWidth > settingsRect.left - tableEl.getBoundingClientRect().y * 2 )
                    tableWidth = settingsRect.left - tableEl.getBoundingClientRect().y * 2;
            }
            else
                tableEl.parentElement.style.width = '';

            tableEl.style.width = tableWidth + 'px';
            tableEl.style.height = tableWidth + 'px';
            settingsEl.style.top = winHeight/2 - settingsRect.height / 2 + 'px';
            shulte.alignCells();
        }


    </script>
</body>
